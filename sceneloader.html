<!DOCTYPE html>
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta charset="utf-8">
        <title>ThreeJS SceneLoader</title>
        <script src="thirdparty/jquery-2.0.3.min.js"></script>
        <script src="thirdparty/greensock/TweenMax.min.js"></script>
        <script src="thirdparty/stats.min.js"></script>
        <script src="http://cdnjs.cloudflare.com/ajax/libs/three.js/r61/three.min.js"></script>
        <script src="thirdparty/TrackballControls.js"></script>
        <script>
            window.onload = function () {
              init();
            };

            var camera, scene, renderer, stats, controls;

            var init = function () {

              renderer = new THREE.WebGLRenderer();
              renderer.setSize( window.innerWidth, window.innerHeight );
              document.body.appendChild( renderer.domElement );

              camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 1, 1000 );
              camera.position.z = 500;

              //
              var loader = new THREE.ObjectLoader();
              loader.load( "data/scene.json", callbackFinished );

              //
              stats = new Stats();
              stats.domElement.style.position = 'absolute';
              stats.domElement.style.top = '0px';
              stats.domElement.style.zIndex = 100;
              document.body.appendChild( stats.domElement );

              controls = new THREE.TrackballControls( camera );
              controls.rotateSpeed = 1.0;
              controls.zoomSpeed = 1.2;
              controls.panSpeed = 0.8;

              controls.noZoom = false;
              controls.noPan = false;

              controls.staticMoving = true;
              controls.dynamicDampingFactor = 0.3;

              controls.keys = [ 65, 83, 68 ];

              controls.addEventListener( 'change', render );

              //
              $(window).resize(resize);
            }

            var callbackFinished = function ( result ) {
              scene = result;

              var planeMesh = scene.getObjectByName('Plane 1');
              planeMesh.material.side = THREE.DoubleSide;

              var texture = THREE.ImageUtils.loadTexture( 'images/crate.gif' );
              var material = new THREE.MeshBasicMaterial( { map: texture } );

              var cubeMesh = scene.getObjectByName('Cube 2');

              cubeMesh.material.needsUpdate = true;
              cubeMesh.geometry.buffersNeedUpdate = true;
              cubeMesh.geometry.uvsNeedUpdate = true;
              cubeMesh.material = material;

              animate();
            };

            var render = function () {
              renderer.render(scene, camera);
            }

            var animate = function () {
              requestAnimationFrame( animate );

              controls.update();
              render();

              stats.update();
            }

            var resize = function () {

              camera.aspect = window.innerWidth / window.innerHeight;
              camera.updateProjectionMatrix();

              renderer.setSize( window.innerWidth, window.innerHeight );

              controls.handleResize();

              render();
            }
        </script>
        <style media="screen">
            body{
              background-color: #ffffff;
              margin: 0;
              overflow: hidden;
              font-family: sans-serif;
            }
        </style>
    </head>
    <body>
    </body>
    </html>